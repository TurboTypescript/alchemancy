var SketchPane=function(t){function e(e){for(var i,a,o=e[0],h=e[1],l=e[2],u=0,c=[];u<o.length;u++)a=o[u],s[a]&&c.push(s[a][0]),s[a]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(t[i]=h[i]);for(d&&d(e);c.length;)c.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],i=!0,o=1;o<r.length;o++){var h=r[o];0!==s[h]&&(i=!1)}i&&(n.splice(e--,1),t=a(a.s=r[0]))}return t}var i={},s={1:0},n=[];function a(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=i,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},a.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/dist";var o=window.webpackJsonpSketchPane=window.webpackJsonpSketchPane||[],h=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var d=h;return n.push([202,0]),r()}({201:function(t,e,r){const i=r(20),s=r(99),n=r(38),a=r(95),o=r(94),h=r(92),l=r(91);class d{constructor(t={backgroundColor:16777215}){this.layerMask=void 0,this.layerBackground=void 0,this.images={brush:{},grain:{}},this.viewportRect=void 0,this.onStrokeBefore=t.onStrokeBefore,this.onStrokeAfter=t.onStrokeAfter,this.setup(t),this.setImageSize(t.imageWidth,t.imageHeight)}setup(t){s.setup(),s.view.setAutoUpdate(!1),i.settings.FILTER_RESOLUTION=1,i.settings.PRECISION_FRAGMENT=i.PRECISION.HIGH,i.settings.MIPMAP_TEXTURES=!0,i.settings.WRAP_MODE=i.WRAP_MODES.REPEAT,i.utils.skipHello(),this.app=new i.Application({backgroundColor:t.backgroundColor,antialias:!1}),this.app.renderer.roundPixels=!1,this.sketchPaneContainer=new i.Container,this.sketchPaneContainer.name="sketchPaneContainer",this.layerContainer=new i.Container,this.layerContainer.name="layerContainer",this.sketchPaneContainer.addChild(this.layerContainer),this.strokeContainer=new i.Container,this.strokeContainer.name="static",this.liveStrokeContainer=new i.Container,this.liveStrokeContainer.name="live",this.layerContainer.addChild(this.liveStrokeContainer),this.offscreenContainer=new i.Container,this.offscreenContainer.name="offscreen",this.offscreenContainer.renderable=!1,this.layerContainer.addChild(this.offscreenContainer),this.eraseMask=new i.Sprite,this.eraseMask.name="eraseMask",this.cursor=new h(this),this.sketchPaneContainer.addChild(this.cursor),this.app.stage.addChild(this.sketchPaneContainer),this.sketchPaneContainer.scale.set(1)}setImageSize(t,e){this.width=t,this.height=e,this.layerMask=(new i.Graphics).beginFill(0,1).drawRect(0,0,this.width,this.height).endFill(),this.layerMask.name="layerMask",this.layerContainer.mask=this.layerMask,this.sketchPaneContainer.addChild(this.layerMask),this.layerBackground=(new i.Graphics).beginFill(16777215).drawRect(0,0,this.width,this.height).endFill(),this.layerBackground.name="background",this.layerContainer.addChild(this.layerBackground),this.eraseMask.texture=i.RenderTexture.create(this.width,this.height),this.centerContainer(),this.layers=new l({renderer:this.app.renderer,width:this.width,height:this.height}),this.layers.onAdd=this.onLayersCollectionAdd.bind(this),this.layers.onSelect=this.onLayersCollectionSelect.bind(this)}onLayersCollectionAdd(t){let e=this.layers[t];this.layerContainer.position.set(0,0),this.layerContainer.addChild(e.sprite),this.centerContainer()}onLayersCollectionSelect(t){this.updateLayerDepths()}updateLayerDepths(){let t=this.layers.getCurrentIndex(),e=this.layers[t];this.layerContainer.setChildIndex(this.layerBackground,0);let r=1;for(let t of this.layers)this.layerContainer.setChildIndex(t.sprite,r),t.sprite===e.sprite&&(this.layer=r-1,this.layerContainer.setChildIndex(this.offscreenContainer,++r),this.layerContainer.setChildIndex(this.liveStrokeContainer,++r)),r++}newLayer(){return this.layers.create()}centerContainer(){this.sketchPaneContainer.pivot.set(this.width/2,this.height/2),this.sketchPaneContainer.position.set(Math.floor(this.app.renderer.width/2),Math.floor(this.app.renderer.height/2))}resize(t,e){this.app.renderer.resize(t,e);let r=(t/e>this.width/this.height?[this.width*e/this.height,e]:[t,this.height*t/this.width])[0]/this.width;this.sketchPaneContainer.scale.set(r),this.sketchPaneContainer.position.set(Math.floor(this.app.renderer.width/2),Math.floor(this.app.renderer.height/2)),this.viewportRect=this.app.view.getBoundingClientRect()}async loadBrushes({brushes:t,brushImagePath:e}){this.brushes=t.reduce((t,e)=>(t[e.name]=new a(e),t),{});let r=[...new Set(Object.values(this.brushes).map(t=>t.settings.brushImage))],s=[...new Set(Object.values(this.brushes).map(t=>t.settings.grainImage))],n=[];for(let[t,a]of[[r,this.images.brush],[s,this.images.grain]])for(let r of t){let t=i.Sprite.fromImage(`${e}/${r}.png`);t.renderable=!1,a[r]=t;let s=t._texture.baseTexture;s.hasLoaded?n.push(Promise.resolve(t)):s.isLoading?n.push(new Promise((t,e)=>{s.on("loaded",e=>t(s)),s.on("error",t=>e(t))})):n.push(Promise.reject(new Error))}await Promise.all(n),this.cursor.updateSize()}stampStroke(t,e){e.draw(t,!1)}disposeContainer(t){for(let e of t.children)e.destroy({children:!0,texture:!1,baseTexture:!1});t.removeChildren()}addStrokeNode(t,e,r,s,n,a,h,l,d,u,c,p,f,g){let y=new i.Sprite.from(this.images.brush[c.settings.brushImage].texture),m=s-(1-l)*s*c.settings.pressureSize;m*=u/90*c.settings.tiltSize*3+1;let k,C=1-(1-l)*c.settings.pressureOpacity;C*=(1-u/90*c.settings.tiltOpacity)*n,k=c.settings.azimuth?d*Math.PI/180-this.sketchPaneContainer.rotation:0-this.sketchPaneContainer.rotation;let S=45*Math.PI/180,x=Math.abs(m*Math.sin(S))+Math.abs(m*Math.cos(S)),v=Math.ceil(x);a-=v/2,h-=v/2,y.x=Math.floor(a),y.y=Math.floor(h),y.width=v,y.height=v;let w=a-y.x,b=h-y.y,M=m/y.width,I=[w,b],P=[M,M],_=this.images.grain[c.settings.grainImage];this.offscreenContainer.addChild(_),this.offscreenContainer.getLocalBounds();let L=new o(_);L.filterArea=this.app.screen,L.uniforms.uRed=t,L.uniforms.uGreen=e,L.uniforms.uBlue=r,L.uniforms.uOpacity=C,L.uniforms.uRotation=k,L.uniforms.uBleed=Math.pow(1-l,1.6)*c.settings.pressureBleed,L.uniforms.uGrainScale=c.settings.scale,L.uniforms.uGrainRotation=c.settings.rotation,L.uniforms.u_x_offset=p*c.settings.movement,L.uniforms.u_y_offset=f*c.settings.movement,L.uniforms.u_offset_px=I,L.uniforms.u_node_scale=P,L.padding=1,y.filters=[L],g.addChild(y)}down(t,e={}){this.pointerDown=!0,this.strokeBegin(t,e),this.app.view.style.cursor="none",this.cursor.render(t)}move(t){this.pointerDown&&this.strokeContinue(t),this.app.view.style.cursor="none",this.cursor.render(t)}up(t){this.pointerDown&&this.strokeEnd(t),this.app.view.style.cursor="auto",this.cursor.render(t)}strokeBegin(t,e){this.strokeState={isErasing:!!e.erase,layerIndices:e.erase?e.erase:[this.layers.currentIndex],points:[],path:new s.Path,lastStaticIndex:0,lastSpacing:void 0,grainOffset:this.brush.settings.randomOffset?{x:Math.floor(100*Math.random()),y:Math.floor(100*Math.random())}:{x:0,y:0},size:this.brushSize,color:this.brushColor,opacity:this.brushOpacity},this.onStrokeBefore&&this.onStrokeBefore(this.strokeState),this.addPointerEventAsPoint(t),this.strokeState.isErasing?this.liveStrokeContainer.parent&&this.liveStrokeContainer.parent.removeChild(this.liveStrokeContainer):(this.liveStrokeContainer.alpha=this.getLayerOpacity(this.layers.currentIndex),this.layerContainer.addChild(this.liveStrokeContainer),this.updateLayerDepths()),this.drawStroke()}strokeContinue(t){this.addPointerEventAsPoint(t),this.drawStroke()}strokeEnd(t){this.addPointerEventAsPoint(t),this.stopDrawing()}stopDrawing(){this.drawStroke(!0),this.disposeContainer(this.liveStrokeContainer),this.offscreenContainer.removeChildren(),this.layers.markDirty(this.strokeState.layerIndices),this.strokeState.isErasing&&(this.layerContainer.addChild(this.liveStrokeContainer),this.updateLayerDepths()),this.pointerDown=!1,this.onStrokeAfter&&this.onStrokeAfter(this.strokeState)}getInterpolatedStrokeInput(t,e){let r=[],i=[];for(let t=0;t<e.segments.length;t++)e.segments[t].location&&i.push(e.segments[t].location.offset);let s=0,n=Math.max(1,this.strokeState.size*this.brush.settings.spacing);null==this.strokeState.lastSpacing&&(this.strokeState.lastSpacing=n);let a=n-this.strokeState.lastSpacing,o=e.length,h=0,l=o+-(this.strokeState.lastSpacing+o),d=!1;for(0===o&&(a=0,o=n,d=!0),h=a;h<o;h+=n){let n,a,o,c=e.getPointAt(h);for(var u=s;u<i.length;u++)i[u]<h&&(s=u);if(d)n=t[s].pressure,a=t[s].tiltAngle,o=t[s].tilt;else{let e=(h-i[s])/(i[s+1]-i[s]);n=this.constructor.utils.lerp(t[s].pressure,t[s+1].pressure,e),a=this.constructor.utils.lerp(t[s].tiltAngle,t[s+1].tiltAngle,e),o=this.constructor.utils.lerp(t[s].tilt,t[s+1].tilt,e)}r.push([this.strokeState.isErasing?0:(this.strokeState.color>>16&255)/255,this.strokeState.isErasing?0:(this.strokeState.color>>8&255)/255,this.strokeState.isErasing?0:(255&this.strokeState.color)/255,this.strokeState.size,this.strokeState.opacity,c.x,c.y,n,a,o,this.brush,this.strokeState.grainOffset.x,this.strokeState.grainOffset.y]),l=h}return this.strokeState.lastSpacing=o-l,r}addStrokeNodes(t,e,r){let i=this.getInterpolatedStrokeInput(t,e);for(let t of i)this.addStrokeNode(...t,r)}localizePoint(t){return this.sketchPaneContainer.toLocal({x:t.x-this.viewportRect.x,y:t.y-this.viewportRect.y},this.app.stage)}addPointerEventAsPoint(t){let e=this.localizePoint(t),r="mouse"===t.pointerType?t.pressure>0?.5:0:t.pressure,i="mouse"===t.pointerType?{angle:-90,tilt:37}:this.constructor.utils.calcTiltAngle(t.tiltX,t.tiltY);this.strokeState.points.push({x:e.x,y:e.y,pressure:r,tiltAngle:i.angle,tilt:i.tilt}),this.strokeState.lastStaticIndex=Math.max(0,this.strokeState.lastStaticIndex-1),this.strokeState.points=this.strokeState.points.slice(Math.max(0,this.strokeState.lastStaticIndex-1),this.strokeState.points.length),this.strokeState.path=new s.Path(this.strokeState.points),this.strokeState.path.smooth({type:"catmull-rom",factor:.5})}drawStroke(t=!1){let e=this.strokeState.points.length;if(t){let t=this.strokeState.lastStaticIndex,e=this.strokeState.points.length-1;return this.addStrokeNodes(this.strokeState.points.slice(t,e+1),new s.Path(this.strokeState.path.segments.slice(t,e+1)),this.strokeContainer),this.strokeState.isErasing?this.updateMask(this.strokeContainer,!0):this.stampStroke(this.strokeContainer,this.layers.getCurrentLayer()),this.disposeContainer(this.strokeContainer),void this.offscreenContainer.removeChildren()}if(e>=3){let t=this.strokeState.points.length-1,e=t-2,r=t-1;this.addStrokeNodes(this.strokeState.points.slice(e,r+1),new s.Path(this.strokeState.path.segments.slice(e,r+1)),this.strokeContainer),this.strokeState.isErasing?this.updateMask(this.strokeContainer):this.stampStroke(this.strokeContainer,this.layers.getCurrentLayer()),this.disposeContainer(this.strokeContainer),this.offscreenContainer.removeChildren(),this.strokeState.lastStaticIndex=r}if(e>=2){this.disposeContainer(this.liveStrokeContainer);let t=this.strokeState.points.length-1,e=t-1,r=t;if(this.strokeState.isErasing);else{let t=this.strokeState.lastSpacing;this.addStrokeNodes(this.strokeState.points.slice(e,r+1),new s.Path(this.strokeState.path.segments.slice(e,r+1)),this.liveStrokeContainer),this.strokeState.lastSpacing=t}}}updateMask(t,e=!1){if(!this.strokeState.layerIndices.map(t=>this.layers[t]).sort((t,e)=>((t,e)=>e-t)(t.sprite.parent.getChildIndex(t.sprite),e.sprite.parent.getChildIndex(e.sprite)))[0].sprite.mask){this.layerContainer.addChild(this.eraseMask);let t=(new i.Graphics).beginFill(16711680,1).drawRect(0,0,this.width,this.height).endFill();this.app.renderer.render(t,this.eraseMask.texture,!0);for(let t of this.strokeState.layerIndices){this.layers[t].sprite.mask=this.eraseMask}}if(this.app.renderer.render(t,this.eraseMask.texture,!1),e)for(let t of this.strokeState.layerIndices){let e=this.layers[t];e.sprite.addChild(this.eraseMask),e.sprite.mask=this.eraseMask,this.layers[t].rewrite(),e.sprite.mask=null,e.sprite.removeChild(this.eraseMask)}}replaceLayer(t,e,r=!0){t=null==t?this.layers.getCurrentIndex():t,this.layers[t].replace(e,r)}getLayerCanvas(t){return console.warn("SketchPane#getLayerCanvas is deprecated. Please fix the caller to use a different method."),console.trace(),t=null==t?this.layers.getCurrentIndex():t,this.app.renderer.plugins.extract.canvas(this.layers[t].sprite.texture)}exportLayer(t,e="base64"){return t=null==t?this.layers.getCurrentIndex():t,this.layers[t].export(e)}extractThumbnailPixels(t,e,r=[]){let s=i.RenderTexture.create(t,e);for(let n of this.layers)if(r.length&&r.includes(n.index)){let r=new i.Sprite(n.sprite.texture);r.alpha=n.sprite.alpha,r.scale.set(t/this.width,e/this.height),this.app.renderer.render(r,s,!1)}return this.app.renderer.plugins.extract.pixels(s)}clearLayer(t){t=null==t?this.layers.getCurrentIndex():t,this.layers[t].clear()}getNumLayers(){return this.layers.length-1}getCurrentLayerIndex(t){return this.layers.getCurrentIndex()}setCurrentLayerIndex(t){this.pointerDown||this.layers.setCurrentIndex(t)}set brushSize(t){this._brushSize=t,this.cursor.updateSize()}get brushSize(){return this._brushSize}isDrawing(){return this.pointerDown}getLayerOpacity(t){return this.layers[t].getOpacity()}setLayerOpacity(t,e){this.layers[t].setOpacity(e)}markLayersDirty(t){return this.layers.markDirty(t)}clearLayerDirty(t){this.layers[t].setDirty(!1)}getLayerDirty(t){return this.layers[t].getDirty()}isLayerEmpty(t){return this.layers[t].isEmpty()}getDOMElement(){return this.app.view}flipLayers(t=!1){this.layers.flip(t)}}d.utils=n,t.exports=d},202:function(t,e,r){const i=r(201);t.exports=i},38:function(t,e,r){const i=r(20);t.exports=class{static rotatePoint(t,e,r,i,s){return{x:Math.cos(s)*(t-r)-Math.sin(s)*(e-i)+r,y:Math.sin(s)*(t-r)+Math.cos(s)*(e-i)+i}}static calcTiltAngle(t,e){return{angle:Math.atan2(t,e)*(180/Math.PI),tilt:Math.max(Math.abs(t),Math.abs(e))}}static lerp(t,e,r){return t+(e-t)*(r=(r=r<0?0:r)>1?1:r)}static arrayPostDivide(t){for(let e=0;e<t.length;e+=4){const r=t[e+3];r&&(t[e]=Math.round(Math.min(255*t[e]/r,255)),t[e+1]=Math.round(Math.min(255*t[e+1]/r,255)),t[e+2]=Math.round(Math.min(255*t[e+2]/r,255)))}}static pixelsToCanvas(t,e,r){let s=new i.CanvasRenderTarget(e,r),n=s.context.createImageData(e,r);return n.data.set(t),s.context.putImageData(n,0,0),s.canvas}static dataURLToFileContents(t){return t.replace(/^data:image\/\w+;base64,/,"")}}},90:function(t,e,r){const i=r(20),s=r(38);t.exports=class{constructor({renderer:t,width:e,height:r}){this.renderer=t,this.width=e,this.height=r,this.sprite=new i.Sprite(i.RenderTexture.create(this.width,this.height)),this.dirty=!1}getOpacity(){return this.sprite.alpha}setOpacity(t){this.sprite.alpha=t}pixels(){return this.renderer.plugins.extract.pixels(this.sprite.texture)}toCanvas(){let t=this.pixels();return s.arrayPostDivide(t),s.pixelsToCanvas(t,this.width,this.height)}toDataURL(){return this.toCanvas().toDataURL()}export(t){return s.dataURLToFileContents(this.toDataURL())}draw(t,e=!1){this.renderer.render(t,this.sprite.texture,e)}clear(){this.draw(i.Sprite.from(i.Texture.EMPTY),!0)}replace(t,e=!0){this.draw(new i.Sprite.from(t),e)}replaceTextureFromCanvas(t){this.sprite.texture.destroy(!0),this.sprite.texture=i.Texture.from(t)}rewrite(){let t=this.sprite.alpha;this.sprite.alpha=1,this.replaceTexture(this.sprite),this.sprite.alpha=t}replaceTexture(t){let e=i.RenderTexture.create(this.width,this.height);this.renderer.render(t,e,!0),this.sprite.texture=e}isEmpty(){let t=this.renderer.plugins.extract.pixels(this.sprite.texture);for(let e of t)if(0!==e)return!1;return!0}getDirty(){return this.dirty}setDirty(t){this.dirty=t}setVisible(t){this.sprite.visible=t}getVisible(){return this.sprite.visible}flip(t=!1){let e=new i.Sprite(this.sprite.texture);e.anchor.set(.5,.5),t?(e.pivot.set(-e.width/2,e.height/2),e.scale.y*=-1):(e.pivot.set(e.width/2,-e.height/2),e.scale.x*=-1),this.replaceTexture(e)}}},91:function(t,e,r){const i=r(90);t.exports=class extends Array{constructor({renderer:t,width:e,height:r}){super(),this.renderer=t,this.width=e,this.height=r,this.currentIndex=void 0,this.onAdd=void 0,this.onSelect=void 0}create(){let t=new i({renderer:this.renderer,width:this.width,height:this.height});return this.add(t),t}add(t){let e=this.length;return this.push(t),t.index=e,t.name=`Layer ${e+1}`,t.sprite.name=t.name,this.onAdd&&this.onAdd(t.index),t}markDirty(t){for(let e of t)this[e].setDirty(!0)}getCurrentIndex(){return this.currentIndex}setCurrentIndex(t){this.currentIndex=t,this.onSelect&&this.onSelect(t)}getCurrentLayer(){return this[this.currentIndex]}flip(t=!1){for(let e of this)e.flip(t)}}},92:function(t,e,r){const i=r(20);t.exports=class extends i.Sprite{constructor(t){super(),this.container=t,this.name="cursorSprite",this.gfx=new i.Graphics,this.addChild(this.gfx),this._enabled=!0,this.visible=!1,this.updateSize()}render(t){let e=this.container.localizePoint(t);this.position.set(e.x,e.y),this.anchor.set(.5),this._enabled&&(this.visible=!0)}updateSize(){let t=.7*this.container.brushSize;this.gfx.clear().lineStyle(1,16777215,0).drawCircle(0,0,Math.ceil(1*t)+2).closePath().lineStyle(1,16777215).drawCircle(0,0,Math.ceil(1*t)-1).closePath().lineStyle(1,0).drawCircle(0,0,Math.ceil(1*t)).closePath(),this.texture=this.gfx.generateCanvasTexture(),this.getLocalBounds()}setEnabled(t){this._enabled=t,this._enabled||(this.visible=!1)}getEnabled(){return this._enabled}}},93:function(t,e){t.exports="precision highp float;\n\n// brush texture\nuniform sampler2D uSampler;\n// grain texture\nuniform sampler2D u_grainTex;\n\n// color\nuniform float uRed;\nuniform float uGreen;\nuniform float uBlue;\n\n// node\nuniform float uOpacity;\nuniform float uRotation;\n\n// grain\nuniform float uBleed;\nuniform float uGrainRotation;\nuniform float uGrainScale;\nuniform float u_x_offset;\nuniform float u_y_offset;\n\n// brush\nuniform vec2 u_offset_px;\nuniform vec2 u_node_scale;\n\n// from vert shader\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\n// from PIXI\nuniform vec4 filterArea;\nuniform vec2 dimensions;\nuniform vec4 filterClamp;\nuniform mat3 filterMatrix;\n\nvec2 rotate (vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvec2 scale (vec2 v, vec2 _scale) {\n\tmat2 m = mat2(_scale.x, 0.0, 0.0, _scale.y);\n\treturn m * v;\n}\n\nvec2 mapCoord (vec2 coord) {\n  coord *= filterArea.xy;\n  return coord;\n}\n\nvec2 unmapCoord (vec2 coord) {\n  coord /= filterArea.xy;\n  return coord;\n}\n\nvoid main(void) {\n  // user's intended brush color\n  vec3 color = vec3(uRed, uGreen, uBlue);\n\n\t//\n\t//\n\t// brush\n\t//\n  vec2 coord = mapCoord(vTextureCoord) / dimensions;\n\n\t// translate by the subpixel\n\tcoord -= u_offset_px / dimensions;\n\n  // move space from the center to the vec2(0.0)\n  coord -= vec2(0.5);\n\n  // rotate the space\n  coord = rotate(coord, uRotation);\n\n  // move it back to the original place\n  coord += vec2(0.5);\n\n\t// scale\n\tcoord -= 0.5;\n  coord *= 1.0 / u_node_scale;\n\tcoord += 0.5;\n\n\tcoord = unmapCoord(coord * dimensions);\n\n\t//\n\t//\n\t// grain\n\t//\n\tvec2 fcoord = vFilterCoord;\n\tfcoord -= vec2(u_x_offset, u_y_offset);\n\tfcoord /= uGrainScale;\n\tvec4 grainSample = texture2D(u_grainTex, fract(fcoord));\n\n\t//\n\t//\n\t// set gl_FragColor\n\t//\n\t// clamp (via https://github.com/pixijs/pixi.js/wiki/v4-Creating-Filters#bleeding-problem)\n\tif (coord == clamp(coord, filterClamp.xy, filterClamp.zw)) {\n\t\t// read a sample from the texture\n\t  vec4 brushSample = texture2D(uSampler, coord);\n\t  // tint\n\t  gl_FragColor = vec4(color, 1.);\n\t\tgl_FragColor *= ((brushSample.r * grainSample.r * (1.0+uBleed))- uBleed ) * (1.0+ uBleed) * uOpacity;\n\n\t\t// gl_FragColor = grain;\n\t} else {\n\t\t// don't draw\n\t\tgl_FragColor = vec4(0.);\n\t}\n}\n"},94:function(t,e,r){const i=r(93);t.exports=class extends PIXI.Filter{constructor(t){super(null,i,{uRed:{type:"1f",value:.5},uGreen:{type:"1f",value:.5},uBlue:{type:"1f",value:.5},uOpacity:{type:"1f",value:1},uRotation:{type:"1f",value:0},uBleed:{type:"1f",value:0},uGrainRotation:{type:"1f",value:0},uGrainScale:{type:"1f",value:1},u_x_offset:{type:"1f",value:0},u_y_offset:{type:"1f",value:0},u_offset_px:{type:"vec2"},u_node_scale:{type:"vec2",value:[0,0]},u_grainTex:{type:"sampler2D",value:""},dimensions:{type:"vec2",value:[0,0]},filterMatrix:{type:"mat3"}}),this.padding=0,this.blendMode=PIXI.BLEND_MODES.NORMAL,this.autoFit=!1;let e=new PIXI.Matrix;t.renderable=!1,this.grainSprite=t,this.grainMatrix=e,this.uniforms.u_grainTex=t._texture,this.uniforms.filterMatrix=e}apply(t,e,r,i){this.uniforms.dimensions[0]=e.sourceFrame.width,this.uniforms.dimensions[1]=e.sourceFrame.height,this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.grainMatrix,this.grainSprite),t.applyFilter(this,e,r,i)}}},95:function(t,e){const r={name:"default",blendMode:"normal",sizeLimitMax:1,sizeLimitMin:0,opacityMax:1,opacityMin:0,spacing:0,brushImage:"brushcharcoal",brushRotation:0,brushImageInvert:!1,grainImage:"graingrid",grainRotation:0,grainImageInvert:!1,movement:1,scale:1,zoom:0,rotation:0,randomOffset:!0,azimuth:!0,pressureOpacity:1,pressureSize:1,pressureBleed:0,tiltAngle:0,tiltOpacity:1,tiltGradiation:0,tiltSize:1,orientToScreen:!0};t.exports=class{constructor(t){this.settings=Object.assign({},r,t)}}},96:function(t,e){},98:function(t,e){}});